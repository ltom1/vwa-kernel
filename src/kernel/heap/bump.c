///////////////////////////////////////////////////////////////////////////////////////////////////
/// @file
/// @brief  Bump Heap Allocator.
///////////////////////////////////////////////////////////////////////////////////////////////////

#include <paging.h>
#include <types.h>
#include <alloc.h>
#include <bump.h>
#include <pmem.h>
#include <vmem.h>
#include <tty.h>


///////////////////////////////////////////////////////////////////////////////////////////////////
/// @brief  Allocates heap memory using a Bump Allocator.
///
/// @param  self    A pointer to the Bump Allocator Structure.
/// @param  n_bytes How many bytes to allocate.
/// 
/// @returns    The pointer to the allocated memory.
///////////////////////////////////////////////////////////////////////////////////////////////////

u64 bump_alloc(bump_allocator_t *self, u64 n_bytes) {

    u64 vaddr = self->allocator.base_addr + self->top;
    self->top += n_bytes;
    return vaddr;
}


///////////////////////////////////////////////////////////////////////////////////////////////////
/// @brief  Frees previously allocated memory using a Bump Allocator.
///
/// @param  self    The Bump Allocator that was used for allocating.
/// @param  n_bytes The size of the memory to free.
///////////////////////////////////////////////////////////////////////////////////////////////////

void bump_free(bump_allocator_t *self, u64 n_bytes) {

    self->top -= n_bytes;
}
